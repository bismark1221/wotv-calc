<div class="equipments">
  <div class="leftBlock">
    <h1 class="boldText">FILTERS</h1>
    <div class="filters">
      <div class="boldText" (click)="toogleCollapse('rarity')" [attr.aria-expanded]="!collapsed.rarity">
        Rarity
        <i class="fas fa-chevron-up" *ngIf="!collapsed.rarity" aria-hidden="true"></i>
        <i class="fas fa-chevron-down" *ngIf="collapsed.rarity" aria-hidden="true"></i>
      </div>
      <div class="collapsedFilters" [ngbCollapse]="collapsed.rarity">
        <div *ngFor="let rarity of rarities">
          <input type="checkbox" id="rarity{{ rarity }}" (change)="filterList('rarity', rarity)" [checked]="isFilterChecked.rarity[rarity]"/>
          <label for="rarity{{ rarity }}">{{ rarity }}</label>
        </div>
      </div>

      <hr />

      <div class="boldText" (click)="toogleCollapse('type')" [attr.aria-expanded]="!collapsed.type">
        Types
        <i class="fas fa-chevron-up" *ngIf="!collapsed.type" aria-hidden="true"></i>
        <i class="fas fa-chevron-down" *ngIf="collapsed.type" aria-hidden="true"></i>
      </div>
      <div class="collapsedFilters" [ngbCollapse]="collapsed.type">
        <div *ngFor="let weapon of weapons">
          <input type="checkbox" id="type{{ weapon }}" (change)="filterList('type', weapon)" [checked]="isFilterChecked.type[weapon]"/>
          <label for="type{{ weapon }}">{{ weapon | titlecase }}</label>
        </div>
        <hr class="separatorFilter" />
        <div *ngFor="let armor of armors">
          <input type="checkbox" id="type{{ armor }}" (change)="filterList('type', armor)" [checked]="isFilterChecked.type[armor]"/>
          <label for="type{{ armor }}">{{ armor | titlecase }}</label>
        </div>
        <hr class="separatorFilter" />
        <div>
          <input type="checkbox" id="typeACC" (change)="filterList('type', 'ACC')" [checked]="isFilterChecked.type['ACC']"/>
          <label for="typeACC">Accessory</label>
        </div>
      </div>

      <hr />

      <div class="boldText" (click)="toogleCollapse('acquisition')" [attr.aria-expanded]="!collapsed.acquisition">
        Acquisition
        <i class="fas fa-chevron-up" *ngIf="!collapsed.acquisition" aria-hidden="true"></i>
        <i class="fas fa-chevron-down" *ngIf="collapsed.acquisition" aria-hidden="true"></i>
      </div>
      <div class="collapsedFilters" [ngbCollapse]="collapsed.acquisition">
        <div><a class="unselectAllTypeLink" (click)="unselectAllType()">unselect all</a></div>
        <div *ngFor="let type of acquisitionTypes">
          <input type="checkbox" id="type{{type}}" (change)="filterList('acquisition', type)" [checked]="isFilterChecked.acquisition[type]"/>
          <label for="type{{type}}">{{ type }}</label>
        </div>
      </div>

      <hr />

      <div class="boldText" (click)="toogleCollapse('job')" [attr.aria-expanded]="!collapsed.job">
        Jobs
        <i class="fas fa-chevron-up" *ngIf="!collapsed.job" aria-hidden="true"></i>
        <i class="fas fa-chevron-down" *ngIf="collapsed.job" aria-hidden="true"></i>
      </div>
      <div class="collapsedFilters" [ngbCollapse]="collapsed.job">
        <div *ngFor="let job of jobs">
          <input type="checkbox" id="job{{job.dataId}}" (change)="filterList('job', job.dataId)" [checked]="isFilterChecked.job[job.dataId]"/>
          <label for="job{{job.dataId}}">{{ job.name }}</label>
        </div>
      </div>

      <hr />

      <div class="boldText" (click)="toogleCollapse('equipmentTypes')" [attr.aria-expanded]="!collapsed.equipmentTypes">
        Equipment Types
        <i class="fas fa-chevron-up" *ngIf="!collapsed.equipmentTypes" aria-hidden="true"></i>
        <i class="fas fa-chevron-down" *ngIf="collapsed.equipmentTypes" aria-hidden="true"></i>
      </div>
      <div class="collapsedFilters" [ngbCollapse]="collapsed.equipmentTypes">
        <div *ngFor="let equipmentType of equipmentTypes">
          <input type="checkbox" id="equipmentType{{equipmentType.split('###')[1]}}" (change)="filterList('equipmentTypes', equipmentType)" [checked]="isFilterChecked.equipmentTypes[equipmentType]"/>
          <label for="equipmentType{{equipmentType.split('###')[1]}}">{{ equipmentType.split('###')[1] }}</label>
        </div>
      </div>

      <hr />

      <div class="boldText" (click)="toogleCollapse('equipmentStats')" [attr.aria-expanded]="!collapsed.equipmentStats">
        Stats
        <i class="fas fa-chevron-up" *ngIf="!collapsed.equipmentStats" aria-hidden="true"></i>
        <i class="fas fa-chevron-down" *ngIf="collapsed.equipmentStats" aria-hidden="true"></i>
      </div>
      <div class="collapsedFilters" [ngbCollapse]="collapsed.equipmentStats">
        <div *ngFor="let equipmentStat of equipmentStats">
          <input type="checkbox" id="equipmentStat{{equipmentStat}}" (change)="filterList('equipmentStats', equipmentStat)" [checked]="isFilterChecked.equipmentStats[equipmentStat]"/>
          <label *ngIf="equipmentStat" for="equipmentStat{{equipmentStat}}" >{{ equipmentStat.replace('_', ' ') | titlecase }}</label>
        </div>
      </div>

      <hr />

      <div class="boldText" (click)="toogleCollapse('extra')" [attr.aria-expanded]="!collapsed.extra">
        Has Extra Star ?
        <i class="fas fa-chevron-up" *ngIf="!collapsed.extra" aria-hidden="true"></i>
        <i class="fas fa-chevron-down" *ngIf="collapsed.extra" aria-hidden="true"></i>
      </div>
      <div class="collapsedFilters" [ngbCollapse]="collapsed.extra">
        <div>
          <input type="checkbox" id="limitedYes" (change)="filterList('extra', true)" [checked]="isFilterChecked.extra['true']"/>
          <label for="limitedYes">Yes</label>
        </div>
        <div>
          <input type="checkbox" id="limitedNo" (change)="filterList('extra', false)" [checked]="isFilterChecked.extra['false']"/>
          <label for="limitedNo">No</label>
        </div>
      </div>
    </div>
  </div>

  <div class="rightBlock">
    <div class="upperBlock">
      <div class="searchBlock">
        <i class="fas fa-search" aria-hidden="true"></i>
        <form *ngIf="searchForm" [formGroup]="searchForm" class="search-form">
          <ng-select #SearchBar
            bindLabel="name"
            placeholder="Search for an equipment by name"
            [addTag]="true"
            [multiple]="true"
            [hideSelected]="true"
            (close)="onSearchBarClose()"
            (search)="onSearchBarUpdateTerm($event)"
            (add)="onSearchBarAdd($event)"
            (remove)="getEquipments()"
            formControlName="searchOptions"
            class="search-select"
            [clearable]="false"
          >
          </ng-select>
        </form>
        <i class="far fa-question-circle" (click)="openSearchOptionsModal()"></i>
      </div>

      <div class="underSearchBlock">
        <div class="totalEquipments">
          A total of <span class="countEquipments">{{ getFilteredEquipments().length }}</span> equipments found
          <span *ngIf="filtersCount > 0">({{ filtersCount }} filters activated)</span>
        </div>
        <div class="sortOrderBlock">
          <!-- <div>
            View by :
          </div> -->
          <div class="sortBy">
            <span>Sort by :</span>
            <ng-select placeholder="Select a sort" class="select-sort select-list" [items]="['rarity', 'name', 'releaseDate']" [(ngModel)]="sort" (ngModelChange)="filterEquipments()" [clearable]="false" [searchable]="false">
              <ng-template ng-label-tmp let-item="item">
                {{ (item === 'releaseDate' ? 'Release date' : item) | titlecase }}
              </ng-template>

              <ng-template ng-option-tmp let-item="item">
                {{ (item === 'releaseDate' ? 'Release date' : item) | titlecase }}
              </ng-template>
            </ng-select>
          </div>
          <div class="orderBy">
            <span>Order by :</span>
            <ng-select placeholder="Select a sort" class="select-order select-list" [items]="[{id: 'asc', label: 'Ascending'}, {id: 'desc', label: 'Descending'}]" [(ngModel)]="order" bindValue="id" (ngModelChange)="filterEquipments()" [clearable]="false" [searchable]="false">
              <ng-template ng-label-tmp let-item="item">
                {{ item.id === 'asc' ? 'Ascending' : 'Descending' }}
              </ng-template>

              <ng-template ng-option-tmp let-item="item">
                {{ item.label }}
              </ng-template>
            </ng-select>
          </div>
        </div>
      </div>
    </div>
    <div class="equipmentsList">
      <div class="equipmentsCol" *ngFor="let equipment of getFilteredEquipments()">
        <a [routerLink]="[getRoute('/equipment/' + equipment.slug)]" [routerLinkActive]="['active']">
          <div class="cardIcons">
            <img class="rarityImg" src="{{'assets/rarity/' + equipment.rarity + '.png'}}" />
          </div>
          <div class="equipmentImgBlock">
            <img class="equipmentImg" src="assets/equipments/{{ equipment.image }}.png" onerror="this.src='assets/equipments/placeholder.png';" />
          </div>
          <div class="cardTitle">
            <span class="equipmentName">{{ equipment.name }}</span>
          </div>
        </a>
      </div>
    </div>
  </div>
</div>

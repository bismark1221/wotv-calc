<div class="row">
  <div class="headerText">
    Based on the work of EatMoarRice
  </div>

  <div class="unitBlock" *ngFor="let unitPos of tableUnits">
    <ng-select placeholder="Select an unit" class="select-unit-team" [items]="units" groupBy="rarity" [(ngModel)]="selectedUnits[unitPos]" (ngModelChange)="selectUnit(unitPos)" bindLabel="name" bindValue="dataId" [editableSearchTerm]="true">
      <ng-template ng-label-tmp let-item="item">
        {{item.name}}
      </ng-template>

      <ng-template ng-optgroup-tmp let-item="item" let-index="index">
        <div class="rarityLine">
          <img src="assets/rarity/{{ item.rarity }}.png" /><span>{{ rarityTranslate[item.rarity] }}</span>
        </div>
      </ng-template>

      <ng-template ng-option-tmp let-item="item" let-index="index" let-search="searchTerm">
        <div class="unitLine" id="unit_{{item.dataId}}">
          <div class="unitSelector" id="unitSelector_{{item.dataId}}">
            <div class="unitLogo">
              <img src="assets/units/{{ item.image }}_m.png" />
            </div>
            <div class="unitNameSelector" innerHTML="{{ item.name | highlight: search }}"></div>
          </div>
          <hr />
        </div>
      </ng-template>
    </ng-select>

    <table class="jobTable" *ngIf="jobbedUnits[unitPos]; let unit">
      <tr>
        <td><img class="unitImg" src="assets/units/{{ unit.image }}_m.png" /></td>
        <td><img class="mainJob" src="{{'assets/jobs/' + unit.jobsData[0].image + '.png'}}" title="unit.jobsData[0].name"/></td>
        <td><img class="subJob" src="{{'assets/jobs/' + unit.jobsData[1].image + '.png'}}" title="unit.jobsData[1].name"/></td>
        <td><img class="subJob" src="{{'assets/jobs/' + unit.jobsData[2].image + '.png'}}" title="unit.jobsData[2].name"/></td>
      </tr>
      <tr>
        <td>Start</td>
        <td>
          <select [(ngModel)]="unit.jobsData[0].start" (ngModelChange)="changeLevel('start', unitPos)">
            <option *ngFor="let level of unit.jobsData[0].tableLevel">{{ level }}</option>
          </select>
        </td>
        <td>
          <select [(ngModel)]="unit.jobsData[1].start" (ngModelChange)="changeLevel('start', unitPos)">
            <option *ngFor="let level of unit.jobsData[1].tableLevel">{{ level }}</option>
          </select>
        </td>
        <td>
          <select [(ngModel)]="unit.jobsData[2].start" (ngModelChange)="changeLevel('start', unitPos)">
            <option *ngFor="let level of unit.jobsData[2].tableLevel">{{ level }}</option>
          </select>
        </td>
      </tr>
      <tr>
        <td>Goal</td>
        <td>
          <select [(ngModel)]="unit.jobsData[0].goal" (ngModelChange)="changeLevel('goal', unitPos)">
            <option *ngFor="let level of unit.jobsData[0].tableLevel">{{ level }}</option>
          </select>
        </td>
        <td>
          <select [(ngModel)]="unit.jobsData[1].goal" (ngModelChange)="changeLevel('goal', unitPos)">
            <option *ngFor="let level of unit.jobsData[1].tableLevel">{{ level }}</option>
          </select>
        </td>
        <td>
          <select [(ngModel)]="unit.jobsData[2].goal" (ngModelChange)="changeLevel('goal', unitPos)">
            <option *ngFor="let level of unit.jobsData[2].tableLevel">{{ level }}</option>
          </select>
        </td>
      </tr>
    </table>
  </div>
</div>

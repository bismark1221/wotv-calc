!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("rxjs"),require("rxjs/operators"),require("@angular/common"),require("@angular/router")):"function"==typeof define&&define.amd?define("angulartics2",["exports","@angular/core","rxjs","rxjs/operators","@angular/common","@angular/router"],t):t((e=e||self).angulartics2={},e.ng.core,e.rxjs,e.rxjs.operators,e.ng.common,e.ng.router)}(this,(function(e,t,r,n,i,a){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var o=function(){return(o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function s(e,t,r,n){var i,a=arguments.length,o=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,r,o):i(t,r))||o);return a>3&&o&&Object.defineProperty(t,r,o),o}function c(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}var u=function(){this.pageTracking={autoTrackVirtualPages:!0,basePath:"",excludedRoutes:[],clearIds:!1,clearHash:!1,clearQueryParams:!1,idsRegExp:/^\d+$|^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/},this.developerMode=!1,this.ga={},this.appInsights={},this.gtm={},this.gst={}},l=new t.InjectionToken("ANGULARTICS2"),p=function(){function e(){}return e.prototype.trackLocation=function(e){return new r.BehaviorSubject({url:"/"})},e.prototype.prepareExternalUrl=function(e){return e},e}(),g=function(){function e(e,t){var n=this;this.tracker=e,this.pageTrack=new r.ReplaySubject(10),this.eventTrack=new r.ReplaySubject(10),this.exceptionTrack=new r.ReplaySubject(10),this.setAlias=new r.ReplaySubject(10),this.setUsername=new r.ReplaySubject(10),this.setUserProperties=new r.ReplaySubject(10),this.setUserPropertiesOnce=new r.ReplaySubject(10),this.setSuperProperties=new r.ReplaySubject(10),this.setSuperPropertiesOnce=new r.ReplaySubject(10),this.userTimings=new r.ReplaySubject(10);var i=new u;this.settings=o(o({},i),t.settings),this.settings.pageTracking=o(o({},i.pageTracking),t.settings.pageTracking),this.tracker.trackLocation(this.settings).subscribe((function(e){return n.trackUrlChange(e.url)}))}var i,a;return e.prototype.filterDeveloperMode=function(){var e=this;return n.filter((function(t,r){return!e.settings.developerMode}))},e.prototype.trackUrlChange=function(e){if(this.settings.pageTracking.autoTrackVirtualPages&&!this.matchesExcludedRoute(e)){var t=this.clearUrl(e),r=void 0;r=this.settings.pageTracking.basePath.length?this.settings.pageTracking.basePath+t:this.tracker.prepareExternalUrl(t),this.pageTrack.next({path:r})}},e.prototype.matchesExcludedRoute=function(e){var t,r;try{for(var n=c(this.settings.pageTracking.excludedRoutes),i=n.next();!i.done;i=n.next()){var a=i.value;if(a instanceof RegExp&&a.test(e)||-1!==e.indexOf(a))return!0}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return!1},e.prototype.clearUrl=function(e){var t=this;return this.settings.pageTracking.clearIds||this.settings.pageTracking.clearQueryParams||this.settings.pageTracking.clearHash?e.split("/").map((function(e){return t.settings.pageTracking.clearQueryParams?e.split("?")[0]:e})).map((function(e){return t.settings.pageTracking.clearHash?e.split("#")[0]:e})).filter((function(e){return!t.settings.pageTracking.clearIds||!e.match(t.settings.pageTracking.idsRegExp)})).join("/"):e},e.ctorParameters=function(){return[{type:p},{type:void 0,decorators:[{type:t.Inject,args:[l]}]}]},e.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject(p),t.ɵɵinject(l))},token:e,providedIn:"root"}),e=s([t.Injectable({providedIn:"root"}),(i=1,a=t.Inject(l),function(e,t){a(e,t,i)})],e)}(),f=function(){function e(e,t){this.router=e,this.location=t}return e.prototype.trackLocation=function(e){return this.router.events.pipe(n.filter((function(e){return e instanceof a.NavigationEnd})),n.filter((function(){return!e.developerMode})),n.map((function(e){return{url:e.urlAfterRedirects}})),n.delay(0))},e.prototype.prepareExternalUrl=function(e){return this.location.prepareExternalUrl(e)},e.ctorParameters=function(){return[{type:a.Router},{type:i.Location}]},e.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject(a.Router),t.ɵɵinject(i.Location))},token:e,providedIn:"root"}),e=s([t.Injectable({providedIn:"root"})],e)}(),h=function(){function e(e,t,r){this.elRef=e,this.angulartics2=t,this.renderer=r,this.angularticsProperties={}}return e.prototype.ngAfterContentInit=function(){var e=this;this.renderer.listen(this.elRef.nativeElement,this.angulartics2On||"click",(function(t){return e.eventTrack(t)}))},e.prototype.eventTrack=function(e){var t=this.angularticsAction,r=o(o({},this.angularticsProperties),{eventType:e.type});this.angularticsCategory&&(r.category=this.angularticsCategory),this.angularticsLabel&&(r.label=this.angularticsLabel),this.angularticsValue&&(r.value=this.angularticsValue),this.angulartics2.eventTrack.next({action:t,properties:r})},e.ctorParameters=function(){return[{type:t.ElementRef},{type:g},{type:t.Renderer2}]},s([t.Input("angulartics2On")],e.prototype,"angulartics2On",void 0),s([t.Input()],e.prototype,"angularticsAction",void 0),s([t.Input()],e.prototype,"angularticsCategory",void 0),s([t.Input()],e.prototype,"angularticsLabel",void 0),s([t.Input()],e.prototype,"angularticsValue",void 0),s([t.Input()],e.prototype,"angularticsProperties",void 0),e=s([t.Directive({selector:"[angulartics2On]"})],e)}(),d=function(){function e(){}return e=s([t.NgModule({declarations:[h],exports:[h]})],e)}(),y=function(){function e(){}var r;return r=e,e.forRoot=function(e){return void 0===e&&(e={}),{ngModule:r,providers:[{provide:l,useValue:{settings:e}},{provide:p,useClass:f},g]}},e=r=s([t.NgModule({imports:[d],exports:[h]})],e)}();e.ANGULARTICS2_TOKEN=l,e.AngularRouterTracking=f,e.Angulartics2=g,e.Angulartics2Module=y,e.Angulartics2On=h,e.Angulartics2OnModule=d,e.DefaultConfig=u,e.RouterlessTracking=p,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=angulartics2.umd.min.js.map